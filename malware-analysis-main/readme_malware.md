This repository contains a set of tools for analyzing binary files, extracting useful information, and detecting certain characteristics. These tools leverage various libraries and utilities to provide functionalities such as string extraction, entropy calculation, PE header enumeration, programming language detection, section analysis, packer detection, and YARA rule scanning.

## Table of Contents

- [Installation](#installation)
- [Usage](#usage)
  - [Extract Strings](#extract-strings)
  - [Calculate Entropy](#calculate-entropy)
  - [Enumerate Headers](#enumerate-headers)
  - [Determine Language](#determine-language)
  - [Analyze Sections](#analyze-sections)
  - [Detect Packer](#detect-packer)
  - [Search YARA Signatures](#search-yara-signatures)
- [Contributing](#contributing)
- [License](#license)

## Installation

To use these tools, you need to have Python installed along with the required dependencies. You can install the dependencies using the following command:

```sh
pip install -r requirements.txt
```

Make sure you have the following tools installed and accessible in your system's PATH:
- `strings` (from the binutils package)
- `yara` (YARA tool for malware research)

## Usage

### Extract Strings

Extracts ASCII and Unicode strings from a binary file.

```sh
python main.py extract_strings <file_path> [output]
```

- `<file_path>`: Path to the binary file to analyze.
- `[output]` (optional): Path to the file where the result should be written. If omitted, the result is printed to the console.

### Calculate Entropy

Calculates the entropy of a binary file, providing a measure of the amount of information or disorder.

```sh
python main.py calculate_entropy <file_path> [output]
```

- `<file_path>`: Path to the binary file to analyze.
- `[output]` (optional): Path to the file where the result should be written. If omitted, the result is printed to the console.

### Enumerate Headers

Enumerates the Portable Executable (PE) headers of a binary file.

```sh
python main.py enumerate_headers <file_path> [output]
```

- `<file_path>`: Path to the binary file to analyze.
- `[output]` (optional): Path to the file where the result should be written. If omitted, the result is printed to the console.

### Determine Language

Attempts to determine the programming language used to create a binary file by checking for known indicators in the imported DLLs and section names.

```sh
python main.py determine_language <file_path> [output]
```

- `<file_path>`: Path to the binary file to analyze.
- `[output]` (optional): Path to the file where the result should be written. If omitted, the result is printed to the console.

### Analyze Sections

Analyzes the sections of a Portable Executable (PE) file and provides detailed information about each section.

```sh
python main.py analyze_sections <file_path> [output]
```

- `<file_path>`: Path to the binary file to analyze.
- `[output]` (optional): Path to the file where the result should be written. If omitted, the result is printed to the console.

### Detect Packer

Detects if a binary file has been packed or obfuscated using known packers by searching for specific signatures.

```sh
python main.py detect_packer <file_path> [output]
```

- `<file_path>`: Path to the binary file to analyze.
- `[output]` (optional): Path to the file where the result should be written. If omitted, the result is printed to the console.

### Search YARA Signatures

Scans a binary file using YARA rules compiled from a specified directory and writes the matching results to a file or prints them to the console.

```sh
python main.py search_yara_signatures <file_path> <rules_directory> [output]
```

- `<file_path>`: Path to the binary file to analyze.
- `<rules_directory>`: Path to the directory containing the YARA rule files.
- `[output]` (optional): Path to the file where the result should be written. If omitted, the result is printed to the console.

## Contributing

Contributions are welcome! Please open an issue or submit a pull request for any improvements or bug fixes.


# Documentation 

### `write_output(output, content)`
This function handles writing content to a file or printing it to the console.
- **Parameters:**
  - `output` (str or None): Path to the file where the content should be written. If None, the content is printed to the console.
  - `content` (str): The content to write or print.

### `extract_strings(file_path, output=None)`
This function extracts ASCII and Unicode strings from a binary file using the `strings` tool and writes the result to a file or prints it to the console.
- **Parameters:**
  - `file_path` (str): Path to the binary file to analyze.
  - `output` (str or None): Path to the file where the result should be written. If None, the result is printed to the console.

### `calculate_entropy(file_path, output=None)`
This function calculates the entropy of a file, a measure of the amount of information or disorder, and writes the result to a file or prints it to the console.
- **Parameters:**
  - `file_path` (str): Path to the binary file to analyze.
  - `output` (str or None): Path to the file where the result should be written. If None, the result is printed to the console.

### `enumerate_headers(file_path, output=None)`
This function enumerates the Portable Executable (PE) headers of a binary file and writes the result to a file or prints it to the console.
- **Parameters:**
  - `file_path` (str): Path to the binary file to analyze.
  - `output` (str or None): Path to the file where the result should be written. If None, the result is printed to the console.

### `determine_language(file_path, output=None)`
This function attempts to determine the programming language used to create a binary file by checking for known indicators in the imported DLLs and section names. It writes the result to a file or prints it to the console.
- **Parameters:**
  - `file_path` (str): Path to the binary file to analyze.
  - `output` (str or None): Path to the file where the result should be written. If None, the result is printed to the console.

### `analyze_sections(file_path, output=None)`
This function analyzes the sections of a Portable Executable (PE) file and writes the information to a file or prints it to the console.
- **Parameters:**
  - `file_path` (str): Path to the binary file to analyze.
  - `output` (str or None): Path to the file where the result should be written. If None, the result is printed to the console.

### `detect_packer(file_path, output=None)`
This function detects if a binary file has been packed or obfuscated using known packers by searching for specific signatures. It writes the result to a file or prints it to the console.
- **Parameters:**
  - `file_path` (str): Path to the binary file to analyze.
  - `output` (str or None): Path to the file where the result should be written. If None, the result is printed to the console.

### `compile_yara_rules_from_directory(directory_path)`
This function compiles YARA rules from all `.yar` or `.yara` files in a specified directory and returns a list of compiled rules.
- **Parameters:**
  - `directory_path` (str): Path to the directory containing the YARA rule files.
- **Returns:**
  - `rules` (list): List of compiled YARA rules.

### `search_yara_signatures(file_path, rules_directory, output=None)`
This function scans a binary file using YARA rules compiled from a specified directory and writes the matching results to a file or prints them to the console.
- **Parameters:**
  - `file_path` (str): Path to the binary file to analyze.
  - `rules_directory` (str): Path to the directory containing the YARA rule files.
  - `output` (str or None): Path to the file where the result should be written. If None, the result is printed to the console.